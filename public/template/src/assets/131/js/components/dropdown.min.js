import{getFocusableElements as e}from"./utils.min.js";const t=function(e){this.config=e,this.element=e.element};t.prototype.init=function(){if(!this.config.element)throw new Error("Dropdown Button unbekannt");this.element.setAttribute("aria-expanded",!1),"A"===this.element.nodeName&&this.element.setAttribute("role","button"),this.config.position&&this.element.nextElementSibling.classList.add(`wm-dropdown__content--${this.config.position}`),this.config.class&&this.element.nextElementSibling.classList.add(this.config.class),this.element.addEventListener("click",(e=>{e.preventDefault(),n(this.element)})),this.element.addEventListener("keydown",(e=>{32===e.keyCode&&(e.preventDefault(),n(this.element))})),i(this.element)};const n=e=>{const t="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-expanded",!t)},i=t=>{const n=e(t.nextElementSibling);n[n.length-1].addEventListener("keydown",(e=>{9!==e.keyCode||e.shiftKey||t.setAttribute("aria-expanded",!1)})),document.addEventListener("keydown",(e=>{if(27===e.keyCode){const e=document.querySelectorAll('[data-wm-dropdown][aria-expanded="true"]');if(e.length){for(let t=0;t<e.length;t++)e[t].setAttribute("aria-expanded",!1);e[e.length-1].focus()}}}))},o=()=>{const e=document.querySelectorAll("[data-wm-dropdown]");for(let n=0;n<e.length;n++){const i=e[n],o={element:i};i.dataset.wmDropdownClass&&(o.class=i.dataset.wmDropdownClass),i.dataset.wmDropdownPosition&&(o.position=i.dataset.wmDropdownPosition),new t(o).init()}};export{o as initDropdowns};