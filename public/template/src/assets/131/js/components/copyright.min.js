import{uniq as t}from"./utils.min.js";import{wmToggle as e}from"./toggle.min.js";const o=(t=!1,e,o)=>{const i=document.querySelectorAll('img[title^="copyright:"]');if(0===i.length)return;const c=r(i);c.length&&(n(c,t),s(e,o))},r=t=>{const e=[];if(t.nodeName)i(t,e);else for(const o of t)i(o,e);return e},i=(t,e)=>{const o=t.getAttribute("title");e.push(o.split("copyright: ")[1])},n=(t,o)=>{const r=document.querySelector(".js-wm-photo-credits");if(!document.querySelector(".js-wm-photo-credits"))throw new Error('".js-wm-photo-credits" im Footer fehlt.');if(r.removeAttribute("hidden"),document.querySelector(".wm-photo-credits__list")){const e=document.querySelector(".wm-photo-credits__list");e.innerHTML="",t.length?c(e,t):r.setAttribute("hidden","hidden")}else{const i=document.createElement("ol");if(i.classList.add("wm-photo-credits__list"),c(i,t),o)r.appendChild(i);else{const t=new e({id:"copy"}),o=t.wrapToggle(r.innerHTML,i);o.classList.add("wm-photo-credits__toggle"),r.innerHTML="",r.appendChild(o),t.init(document.querySelectorAll(".wm-photo-credits__toggle"))}}},c=(e,o)=>{const r=t(o);r.sort(((t,e)=>t.localeCompare(e,"en",{sensitivity:"base"}))),r.forEach((t=>{const o=document.createElement("li");o.textContent=t,e.appendChild(o)}))},s=(t,e)=>{const o=t??document.querySelector("[data-wm-site-content]");let i={attributes:!1,childList:!0,characterData:!1,subtree:!0};e&&(i=e);new MutationObserver((t=>{let e=!1;if(t.forEach((t=>{"childList"===t.type&&(e=!0)})),e){const t=document.querySelectorAll('img[title^="copyright:"]'),e=r(t);n(e)}})).observe(o,i)};export{o as initCopyright};