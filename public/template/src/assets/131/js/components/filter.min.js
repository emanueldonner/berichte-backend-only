import{normalizeJSON as t}from"./utils.min.js";const e=function(e){if(0===e.querySelectorAll("[data-filter]").length)throw new Error('Keine Elemente in Filter gefunden oder "data-filter" Attribut auf Elementen fehlt.');this.filter=e,this.items=e.querySelectorAll("[data-filter]"),this.selects=e.querySelectorAll("select");var i=JSON.parse(t(this.items[0].dataset.filter));for(var s in this.filtersList={},i)this.filtersList[s]=""};e.prototype.changeUrl=function(t){var e=new URLSearchParams(location.search);for(var i in this.filtersList)i in this.filtersList&&e.set(i,this.filtersList[i]);window.history.replaceState({},"",location.pathname+"?"+e)},e.prototype.filterList=function(e){if(!e){var i=0;for(var s in this.filtersList)this.filtersList[s]=this.selects[i].value,i++}var r=0;for(let e=0;e<this.items.length;e++){const i=this.items[e];var l=JSON.parse(t(i.dataset.filter));let a=0;for(var s in this.filtersList)""!==this.filtersList[s]&&this.filtersList[s]!==l[s]&&a--;a<0?i.classList.add("wm-u-dn"):(i.classList.remove("wm-u-dn"),r++)}this.changeUrl();var a=this.filter.querySelector("[data-filter-status]"),n=a.dataset.filterStatus.replace("$1",r).replace("$2",this.items.length);a.textContent=n,0===r?this.filter.querySelector(".js-wm-filter-no-result").classList.remove("wm-u-dn"):this.filter.querySelector(".js-wm-filter-no-result").classList.add("wm-u-dn")},e.prototype.init=function(){var t=new URLSearchParams(location.search);if(t.entries().next().value){var e=0;for(var i of t.entries())i[0]in this.filtersList&&(this.filtersList[i[0]]=i[1],this.selects[e].value=i[1],e++);this.filterList(!0)}this.filter.addEventListener("change",(t=>{this.filterList()})),this.filter.classList.add("wm-filter--ready")};const i=document.querySelectorAll(".js-wm-filter");for(let t=0;t<i.length;t++){new e(i[t]).init()}export{e as wmFilter};