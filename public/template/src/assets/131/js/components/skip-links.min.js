import{getFocusableElements as e}from"./utils.min.js";const t=()=>{if(document.querySelector(".js-wm-skip-links")){const e=document.querySelector(".js-wm-skip-links");if(!e)throw new Error("Kein Skip Link Container vorhanden");const t=document.querySelectorAll("[data-skip-link]");if(0!==t.length)for(let n=0;n<t.length;n++){const r=t[n];r.setAttribute("tabindex",-1);const i=document.createElement("a");if(i.classList.add("wm-btn","wm-btn--small","wm-btn--i","js-wm-skip-link"),i.textContent=r.dataset.skipLink,!r.id)throw new Error(`Benutzerdefinierter Skip link "${r.dataset.skipLink}" hat kein id Attribut oder Attributwert.`);i.setAttribute("href",`#${r.id}`),e.insertBefore(i,e.querySelectorAll("li")[e.querySelectorAll("li").length-1])}const o=[document.querySelector(".wm-site-footer")];if(document.querySelector("[data-wm-site-content]"))for(let e=0;e<document.querySelector("[data-wm-site-content]").children.length;e++){const t=document.querySelector("[data-wm-site-content]").children[e];o.push(t)}const s=e.querySelectorAll("a");if(0===s.length)return;for(let e=0;e<s.length;e++){const t=s[e];t.addEventListener("focus",(e=>{i(e,o)})),t.addEventListener("blur",(e=>{i(e,o,"remove")})),t.addEventListener("click",(e=>{const t=e.target.getAttribute("href");if(-1===t.indexOf("http")){e.preventDefault();const i=n(t);document.getElementById(i)&&(document.getElementById(i).focus(),setTimeout((()=>{r()}),300))}}))}}},n=e=>{let t="";return-1!==e.indexOf("#")&&(t=e.split("#")[1]),t},r=()=>{document.querySelector(".wm-skip-links__area")&&document.querySelector(".wm-skip-links__area").classList.remove("wm-skip-links__area")},i=(e,t,i="add")=>{const o=n(e.target.getAttribute("href"));if(r(),""!==o&&document.getElementById(o)){var s=document.getElementById(o),c=s;if(document.querySelector("[data-wm-site-content]")){for(var l=[];!s.hasAttribute("data-wm-site-content");)l.push(s),s=s.parentElement;l.reverse();c=l[0]}for(let e=0;e<t.length;e++){const n=t[e];n&&(n!==c?n.classList[i]("wm-u-o01"):document.getElementById(o).classList[i]("wm-skip-links__area"))}}},o=(t,n="Bereich Ã¼berspringen")=>{const r=e(t),i=s(e(t)[r.length-1]);if(i){const e=document.createElement("button");e.classList.add("wm-section__skip"),e.textContent=n,e.addEventListener("click",(()=>{i.focus()}));t.parentNode.classList.add("wm-u-pr"),t.parentNode.insertBefore(e,t)}},s=t=>{const n=document.querySelector("[data-wm-site-content]"),r=e(n);let i=r.indexOf(t)+1;if(r[i]){for(;null===r[i].offsetParent||t.contains(r[i]);)i+=1;return r[i]}};export{t as initSkipLinks,s as getNextFocusableElement,o as addSkipLink};